---
layout: review_post
title: "[Paper Review] DyRRen: A Dynamic Retriever-Reranker-Generator Model for
Numerical Reasoning over Tabular and Textual Data"
author: Sohyun
date: 2024-08-04
---


이 논문은 수치적 추론(Numerical Reasoning)을 다루는 작업에 대한 연구이다. LLM의 경우 수치 추론을 진행할 때, 잘못된 답을 내놓는 경우가 종종 있다. 이는 숫자를 일종의 텍스트로 취급함으로써 발생하는 문제인데, 이를 해결하기 위해 쓰이는 방법이 크게 두 가지가 있다. 하나는 외부의 수학과 관련된 라이브러리를 활용하는 것이다. 또다른 하나는 수치와 관련된 데이터가 저장되어 있는 외부 데이터베이스를 활용해서 프롬프트를 증강하는(RAG) 방법이다.

해당 논문에서는 후자인 RAG를 통한 방법인 FinQANet이라는 방법의 한계점을 극복하기 위한 방법인 DyRRen 이라는 프레임워크를 제시한다. 이제 이에 대해 자세히 알아보자.

읽다보니 알게 된 것인데 FinQANet이나 DyRRen 모델은 사용자에게 자연어 형태로 무언가 대답을 만드는 것보다는 수학적 표현식을 생성하는 것(+이를 계산하는 것)이 중점을 둔 것으로 보인다. 어쨋든, 읽어보면서 조금 더 살펴보도록 하자.


## Introduce

기존의 데이터셋, 예를 들어 **DROP(Dua et al. 2019)**[^1]은 주로 간단한 계산이나 비교에 중점을 두었다. 이러한 데이터셋은 주어진 정보를 통해 쉽게 계산할 수 있는 문제를 다루며, 복잡한 논리적 추론을 요구하지 않는 경향이 있었다. 하지만, 금융 보고서와 같은 복잡한 실세계 시나리오에서는 보다 정교한 수치적 추론 능력이 필요하다. 이를 위해 개발된 데이터셋인 FinQA와 TAT-QA는 보다 복잡하고 다양한 정보를 포함한 문제를 해결할 수 있도록 설계되었습니다. 이러한 데이터셋은 기계 학습 모델이 복잡한 수치적 표현을 생성하고 이를 바탕으로 올바른 답을 도출할 수 있도록 돕는다.

예를 들어, FinQA의 한 사례에서는, 연도별 판매 기록을 보여주는 표와 관련 금융 정보를 담고 있는 몇 가지 문장이 제공된다. 여기서 질문에 답하기 위해서는 덧셈, 뺄셈 등의 수학 연산을 결정하고, 그 인자를 표나 문장에서 선택하여 올바른 수학 표현식을 생성한 후 답을 계산해야 한다. 경우에 따라, 수학적 표현식의 한 인자(예: 아래 그림의 #0)는 이전 계산 결과일 수 있다.

![1](https://github.com/user-attachments/assets/5cc21b25-0da1-4dd4-8adb-84e33f1e1af9){: .responsive-img .align-center}


기존의 수치 표현 생성 방법은 Retriever 와 Generator 라는 두 가지 모듈로 나누어졌었다. Retriever 의 경우 가장 관련성이 높은 정보를 찾아서 Generator 에 제공하는 역할을 담당하고, Generator 은 Retriever 가 제공한 정보를 바탕으로 수학적 표현을 만들어낸다. **FinQANet (Chen et al. 2021b)**[^2]는 이 분야에서 잘 알려진 방법 중 하나이고, FinQANet은 다음과 같은 방식으로 작동한다.

Retriever Phase: 표를 문장으로 변환하고, BERT 기반의 이진 분류기를 사용하여 관련 문장을 선택한다.
Generator Phase: Encoder-Decoder 모델을 사용하여 수학적 표현을 생성한다. 여기서 인코더는 BERT나 RoBERT를 사용할 수 있으며, LSTM의 히든 레이어 출력이 표현식 토큰을 예측하는 데 사용된다.

하지만 FinQANet에는 몇 가지 한계가 있다.

1. **긴 문장 연결의 문제**: FinQANet의 생성기는 선택된 문장(검색된 문서에서 가져온 것)을 길게 연결하여 인코더에 입력한다. 이는 특정 숫자를 정확히 찾기 어려운 상황을 만든다. 예를 들어, “7%“라는 숫자를 생성해야 할 때, “7%“가 포함된 특정 문장에만 어텐션해야 하지만, FinQANet은 이를 잘 처리하지 못한다. 

2. **Retriever의 단순성**: FinQANet의 리트리버는 단순한 이진 분류기를 사용하여 각 문장이 질문과 관련이 있는지 없는지를 판단한다. 즉, 단순히 “관련 있다” 또는 “관련 없다”로만 분류하기 때문에, 문장 간의 미세한 차이나 복잡한 상호작용을 이해하기 어렵다. 예를 들어, 질문에서 특정 연도(“2015”, “2016”)나 항목(“제3자 판매”)에 집중해야 하지만, 이는 어려운 일이다. 또한 질문에서 요구하는 세부적인 정보를 정확히 찾아내기 위해서는 단순한 관련성 이상의 **정교한 추론**이 필요하다. 예를 들어, 질문이 “2015년과 2016년의 제3자 판매 차이는?“이라고 한다면, 리트리버는 단순히 ‘판매’와 관련된 모든 문장을 선택하는 것보다 더 깊이 있는 분석을 통해 정확한 정보를 찾아야 한다.  

이 논문에서는 위의 문제를 해결하기 위해 **DyRRen**이라는 새로운 프레임워크를 제안한다. DyRRen은 생성의 각 단계에서 문장에 대한 주의를 동적으로 조정하는 **동적 재순위 메커니즘(Dynamic ReRanker Mechanism)**을 사용한다.

  
**DyRRen의 주요 구성 요소**

•  **Generator (생성기)**: 이 모듈은 LSTM과 주의(attention) 메커니즘을 사용하여, 입력된 토큰을 평가하고 다음에 생성할 가능성이 높은 토큰을 찾아낸다. 생성기의 정확성을 높이기 위해 **재순위기(reranker)**를 사용하여 검색된 문장들 중 관련 문장을 동적으로 선택한다.

•  **Reranker (재순위기)**: 생성의 각 단계에서 검색된 문장을 평가하고 순위를 매겨서 목표 숫자를 포함하는 문장을 찾습니다. 이를 위해 생성기의 출력, 이전에 생성된 표현식, 그리고 검색된 문장 간의 관계를 활용하여 각 단계에서 문장을 동적으로 재순위합니다.

•  **Retriever (리트리버)**: 기존의 간단한 BERT 이진 분류기 대신 **밀도 검색(dense retrieval)**을 사용합니다. 검색 성능을 향상시키기 위해 질문과 문장 쌍 간의 정교한 상호작용을 구현하고, 토큰 수준의 늦은 상호작용을 활용합니다. 이 과정에서 긍정적 및 부정적 문장이 다수 포함된 검색 공간을 다루기 위해 손실 함수를 조정합니다.

  

**4. 논문의 기여**

  

이 논문에서 제안하는 주요 기여는 다음과 같습니다:

  

•  **새로운 프레임워크**: 숫자 추론 문제를 해결하기 위한 새로운 **리트리버-재순위기-생성기** 프레임워크를 제안합니다. 특히, 재순위기를 통해 다른 생성 단계에서 목표 정보를 동적으로 찾아낼 수 있도록 합니다.

•  **정교한 리트리버 설계**: 토큰 수준과 쌍별 상호작용을 강화하여 리트리버를 설계하였습니다.

  

**5. 기타 정보**

  

•  **코드**: DyRRen의 코드는 GitHub에서 확인할 수 있습니다: [DyRRen GitHub](https://github.com/nju-websoft/DyRRen).

•  **논문 구조**: 2장에서는 접근 방식을 상세히 설명하고, 3장에서는 실험을 통해 성능을 검증하며, 4장에서는 관련 연구를 논의하고, 마지막으로 5장에서 결론을 제시합니다.

  

이 논문은 복잡한 수치적 추론 문제를 해결하기 위한 새로운 방법론을 제시하며, 특히 **동적 재순위 메커니즘**을 활용하여 생성기의 정확성을 높이는 방법을 설명합니다. 이렇게 해서 기계가 다양한 형식의 데이터를 처리하고 분석할 수 있도록 돕는 기술을 발전시키고자 합니다.

[^1]: [DROP: A Reading Comprehension Benchmark Requiring Discrete Reasoning Over Paragraphs](https://aclanthology.org/N19-1246.pdf)

[^2]:A Numerical Reasoning Question Answering System with Fine-grained Retriever and the Ensemble of Multiple Generators for FINQA
<!--stackedit_data:
eyJoaXN0b3J5IjpbNDkzMzUyODU4LC0xMjAyNjI2OTkzLC0xNz
Y3OTc5NjA5LDIxMzAzOTY3NzYsLTE5OTM2NDIzODgsLTE4NDAw
NjMzMjAsLTE2OTIwMzMyNzMsLTE4ODEwMjk0MDEsMTgyNDY0LC
0xOTAwMTI1MDI1LC0xMzkxNjIyNDA2LDE5NzU5NDgyNjQsODg1
MjAwMzg2LC00ODcyNjczNyw2OTE1OTEzMjQsMjUzMTI2ODU5LC
0zODQ1MTY4MDcsLTE0ODMzNjM0MzgsLTE1Mzk0Nzk3NTIsLTc3
MDQ0NDI3MF19
-->